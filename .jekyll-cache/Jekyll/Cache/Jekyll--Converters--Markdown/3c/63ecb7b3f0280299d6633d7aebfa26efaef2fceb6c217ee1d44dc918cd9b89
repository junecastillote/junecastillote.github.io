I"3<h1 id="excmdreport-module">ExCmdReport Module</h1>

<p>This module uses the <code class="highlighter-rouge">Search-AdminAuditLog</code> Exchange CmdLet under the hood. This can be used to retrieve Exchange Admin Audit Logs from Exchange Online or Exchange Server On-Premises. It uses pagination automatically so that it can retrieve any number of results.</p>

<p>The output can be saved as a pre-formatted HTML file with the option to send as email to specified recipients.</p>

<p><img src="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/images/SampleEmailReport.png" alt="Sample Email Report" /></p>

<h2 id="requirements">Requirements</h2>

<p>This module was tested with the following.</p>

<ul>
  <li>Windows PowerShell 5.1</li>
  <li>Exchange Online (Office 365)</li>
  <li>Exchange Server 2016 (On-Premises).
    <ul>
      <li>May work with Exchange 2013 and Exchange 2019.</li>
    </ul>
  </li>
  <li>Remote PowerShell session must be established.</li>
  <li>Exchange Admin Audit Logging must be enabled. Otherwise, there will be no data to return.</li>
</ul>

<h2 id="how-to-install">How to Install</h2>

<h3 id="option-1-install-from-psgallery">Option 1: Install from PSGallery</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Install-Module ExCmdReport -Scope AllUsers
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="option-2-download-from-github-and-install-manually">Option 2: Download from GitHub and install manually</h3>

<p>Use this if you canâ€™t install the module from PSGallery.</p>

<ol>
  <li>Download or clone from the <a href="https://raw.githubusercontent.com/junecastillote/ExCmdReport">GitHub Repository</a>.</li>
  <li>Extract the zip and run <code class="highlighter-rouge">.\InstallMe.ps1</code> in PowerShell.</li>
</ol>

<p><img src="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/images/SampleInstall.png" alt="Install Selection" /></p>

<h2 id="usage-examples">Usage Examples</h2>

<h3 id="example-1-get-admin-audit-log-entries">Example 1: Get Admin Audit Log Entries</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>&lt;# Get ALL log entries #&gt;
Get-ExCmdLog -searchParamHash @{
    StartDate      = '10/01/2019'
    EndDate        = '10/10/2019'
    ExternalAccess = $false
} -Verbose -resolveAdminName
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/images/SampleOutput01.png" alt="Get Admin Audit Log Entries" /></p>

<h3 id="example-2-get-admin-audit-log-entries-and-send-email-report">Example 2: Get Admin Audit Log Entries and Send Email Report</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>&lt;# Build report parameters #&gt;
$report = @{
    SendEmail = $true
    From = 'admin@domain.com'
    To = 'user1@domain.com','user2@domain.com'
    smtpServer = 'smtp.office365.com'
    port = 587
    UseSSL = $true
    Credential = (Get-Credential)
    TruncateLongValue = 50
}

&lt;# Get Audit Logs and then send #&gt;
Get-ExCmdLog -searchParamHash @{
    StartDate      = '10/01/2019'
    EndDate        = '10/10/2019'
    ExternalAccess = $false
} -Verbose -resolveAdminName | Write-ExCmdReport @report -Verbose
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/images/SampleEmailReport.png" alt="Get Admin Audit Log Entries and Send Email Report" /></p>

<h2 id="functions">Functions</h2>

<p>There are four functions included in this version. For details, follow the links below.</p>

<ul>
  <li><a href="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/Doc/Get-ExCmdLog.md">Get-ExCmdLog</a></li>
  <li><a href="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/Doc/Write-ExCmdReport.md">Write-ExCmdReport</a></li>
  <li><a href="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/Doc/Connect-ExOP.md">Connect-ExOP</a></li>
  <li><a href="https://raw.githubusercontent.com/junecastillote/ExCmdReport/master/Doc/Connect-ExOL.md">Connect-ExOL</a></li>
</ul>
:ET